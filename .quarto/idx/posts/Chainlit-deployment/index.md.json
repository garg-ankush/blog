{"title":"Deploy your chatGPT-like app with Chainlit and AWS ECS","markdown":{"yaml":{"title":"Deploy your chatGPT-like app with Chainlit and AWS ECS","date":"2/9/23","author":"Ankush Garg"},"headingText":"Table of Contents","containsRefs":false,"markdown":"\n![](main.jpg)\n\n🔗💡*Chainlit is an open-source Python package that allows you to create ChatGPT-like UIs on top of any Python code in just minutes! Visit the [GitHub repo](https://github.com/Chainlit/chainlit) to get started!*\n\n**This post is designed to guide you through deploying your Chainlit apps to AWS ECS.**\n\nIn this tutorial, we'll be using this [sample example](https://github.com/garg-ankush/cookbook/tree/aws-ecs-deployment/aws-ecs-deployment). Feel free to use your own application instead.\n\nPrerequisites:\n\n1. Python ≥ 3.9\n2. AWS account\n3. Docker\n\n1. [Create an AWS account and set up credentials 🚀](#Setup)\n2. [Clone the repo - bypass if you already an ongoing chainlit project 🧫](#Clone)\n3. [Dockerfile 🐳](#Dockerfile)\n4. [Run the Chainlit app locally 🏡](#Locally)\n5. [Create ECR and push the image 📌](#ECR)\n6. [Create task definition and service and run task 🏃🏼‍♀️](#RunTask)\n7. [Test out the application 💯](#Test)\n8. [Ideas for next steps 🪜](#NextSteps)\n\n## Step 1: Create an AWS account and set up credentials 🚀 <a name=\"Setup\"></a>\n\nFollow steps in this [blog post](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/configure/index.html) by AWS to configure AWS CLI.\n\n## Step 2: Clone the repo - bypass if you already an ongoing chainlit project 🧫 <a name=\"Clone\"></a>\n\n```bash\ngit clone https://github.com/Chainlit/cookbook.git chainlit-cookbook\n```\n\nNavigate to the app folder:\n\n```bash\ncd chainlit-cookbook/aws-ecs-deployment\n```\n\n## Step 3: Dockerfile 🐳 <a name=\"Dockerfile\"></a>\n\n```python\n# Use an appropriate base image, e.g., python:3.10-slim\nFROM python:3.10-slim\n\n# Set environment variables (e.g., set Python to run in unbuffered mode)\nENV PYTHONUNBUFFERED 1\n\n# Set the working directory\nWORKDIR /app\n\n# Copy your application's requirements and install them\nCOPY requirements.txt /app/\n\nRUN pip install -r /app/requirements.txt\n\n# Copy your application code into the container\nCOPY . /app/\n\nEXPOSE 8080\n\nCMD [\"python\", \"-m\", \"chainlit\", \"run\", \"app.py\", \"-h\", \"--port\", \"8080\"]\n```\n\n**❗ If you’re on Mac M1, replace the first line in Dockerfile with `FROM --platform=linux/amd64 python:3.9-slim`**\n\n> Our app is exposed on port 8080. We’ll be using this port in multiple locations.> \n\n## Step 4: Run the Chainlit app locally 🏡 <a name=\"Locally\"></a>\n\n🚧 Make sure Docker Daemon is running.\n\nFirst, build the docker image and test that the app works locally.\n\n```docker\ndocker build -t chainlit-app:latest .\n```\n\nHere’s what it looks like for me.\n\n![](docker-running-locally.png)\n\nNow, let’s confirm that the image was built successfully.\n\n```docker\ndocker images\n```\n\n![](image-created.png)\n\nLet’s run the app locally and navigate to [`localhost:8080`](http://localhost:8080) 🥂\n\n```python\ndocker run -p 8080:8080 chainlit:latest\n```\n\n![](chainlit-running.png)\n\n## Step 5: Create ECR and push the image 📌 <a name=\"ECR\"></a>\n\nLet’s head over to AWS ECR and create a repository where we’ll push our docker image to.\n\n![](create-ECR-repo.png)\n\nOnce a repository is created, let’s push an image to it. Head over to the repository and click `View push commands`.\n\n![](view-push.png)\n\nLet’s follow the helper commands to push our image to the `Chainlit-demo-app` repository we just created.\n\n🚧 Note, we already created built an image to test the app locally. But that’s ok, let’s rebuild the image again to avoid confusion.\n\n![](push-commands.png)\n\nAwesome, this is what it looks like on my end.\n\n![](pushed.png)\n\nLet’s see if we find the image on AWS.\n\n![](find-pushed-image-aws.png)\n\n🚧 Take note of the image URI - we’ll need it later.\n\nGreat, our repository and our image is set. Let’s head over to ECS to create a service and a task.\n\n## Step 6: Create task definition and service and run task 🏃🏼‍♀️ <a name=\"RunTask\"></a>\n\n### Create a new cluster\n\n![](create-cluster.png)\n\n![](fill-in-cluster-details.png)\n\nClick create and we should see a new cluster `chainlit-demo-app-cluster` has been created for us.\n\n### Create a task definition\n\n![](create-task-definition.png)\n\n![](configure-task-definition.png)\n\n🚧 Make sure the container port matches the port we exposed in the Dockerfile.\n\nLeave everything else as default and create our task definition.\n\n![](fill-in-task-details.png)\n\n### Create a service\n\n![](create-service-1.png)\n\n![](create-service-2.png)\n\n![](create-service-3.png)\n\nWe should be good to create our service. Let’s hit it 👊🏼\n\n🚧 It may take a few minutes for the service to be ready.\n\nMap the ports correctly.\n\n**❗ One last thing we need to do before our task is ready is to allow traffic to the right port. You may have these set up already but if not, set the ports so that you allow all incoming traffic to port 8080.**\n\n![](security-groups.png)\n\n![](edit-inbound-rules-1.png)\n\n![](edit-inbound-rules-2.png)\n\nYour task should be running at this point. Head over to the tasks tab of the `chainlit-demo-app-service` .\n\n![](show-demo-app-service.png)\n\n![](get-public-ip.png)\n\n🚧 Our app is exposed at this public IP: `52.204.71.81:8080`\n\n## Step 7: Test out the application 💯 <a name=\"Test\"></a>\n\nHead over to the public IP in the browser to see our app in action!\n\n![](success.png)\n\n## Step 8: Ideas for next steps 🪜 <a name=\"NextSteps\"></a>\n\n1. We have our app running on a weird public IP address - we can connect it to our own domain.\n2. Load Balancer - Will give us a better performance and high availability.\n3. Right now our is not very secure. AWS Certificate Manager makes getting an SSL certificate relatively straightforward.\n\nI hope this helps the growing Chainlit community! Hit me up in the Chainlit Discord (ankushgarg) if you have any questions about the walkthrough.\n\n**Resources:**\n\n[Deploy to Fly.io](https://dev.to/willydouhard/how-to-deploy-your-chainlit-app-to-flyio-38ja)\n\n[Deploy to GCP](https://pseudohvr.medium.com/deploying-chainlit-on-gcp-72231ba6b77f)","srcMarkdownNoYaml":"\n![](main.jpg)\n\n🔗💡*Chainlit is an open-source Python package that allows you to create ChatGPT-like UIs on top of any Python code in just minutes! Visit the [GitHub repo](https://github.com/Chainlit/chainlit) to get started!*\n\n**This post is designed to guide you through deploying your Chainlit apps to AWS ECS.**\n\nIn this tutorial, we'll be using this [sample example](https://github.com/garg-ankush/cookbook/tree/aws-ecs-deployment/aws-ecs-deployment). Feel free to use your own application instead.\n\nPrerequisites:\n\n1. Python ≥ 3.9\n2. AWS account\n3. Docker\n\n# Table of Contents\n1. [Create an AWS account and set up credentials 🚀](#Setup)\n2. [Clone the repo - bypass if you already an ongoing chainlit project 🧫](#Clone)\n3. [Dockerfile 🐳](#Dockerfile)\n4. [Run the Chainlit app locally 🏡](#Locally)\n5. [Create ECR and push the image 📌](#ECR)\n6. [Create task definition and service and run task 🏃🏼‍♀️](#RunTask)\n7. [Test out the application 💯](#Test)\n8. [Ideas for next steps 🪜](#NextSteps)\n\n## Step 1: Create an AWS account and set up credentials 🚀 <a name=\"Setup\"></a>\n\nFollow steps in this [blog post](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/configure/index.html) by AWS to configure AWS CLI.\n\n## Step 2: Clone the repo - bypass if you already an ongoing chainlit project 🧫 <a name=\"Clone\"></a>\n\n```bash\ngit clone https://github.com/Chainlit/cookbook.git chainlit-cookbook\n```\n\nNavigate to the app folder:\n\n```bash\ncd chainlit-cookbook/aws-ecs-deployment\n```\n\n## Step 3: Dockerfile 🐳 <a name=\"Dockerfile\"></a>\n\n```python\n# Use an appropriate base image, e.g., python:3.10-slim\nFROM python:3.10-slim\n\n# Set environment variables (e.g., set Python to run in unbuffered mode)\nENV PYTHONUNBUFFERED 1\n\n# Set the working directory\nWORKDIR /app\n\n# Copy your application's requirements and install them\nCOPY requirements.txt /app/\n\nRUN pip install -r /app/requirements.txt\n\n# Copy your application code into the container\nCOPY . /app/\n\nEXPOSE 8080\n\nCMD [\"python\", \"-m\", \"chainlit\", \"run\", \"app.py\", \"-h\", \"--port\", \"8080\"]\n```\n\n**❗ If you’re on Mac M1, replace the first line in Dockerfile with `FROM --platform=linux/amd64 python:3.9-slim`**\n\n> Our app is exposed on port 8080. We’ll be using this port in multiple locations.> \n\n## Step 4: Run the Chainlit app locally 🏡 <a name=\"Locally\"></a>\n\n🚧 Make sure Docker Daemon is running.\n\nFirst, build the docker image and test that the app works locally.\n\n```docker\ndocker build -t chainlit-app:latest .\n```\n\nHere’s what it looks like for me.\n\n![](docker-running-locally.png)\n\nNow, let’s confirm that the image was built successfully.\n\n```docker\ndocker images\n```\n\n![](image-created.png)\n\nLet’s run the app locally and navigate to [`localhost:8080`](http://localhost:8080) 🥂\n\n```python\ndocker run -p 8080:8080 chainlit:latest\n```\n\n![](chainlit-running.png)\n\n## Step 5: Create ECR and push the image 📌 <a name=\"ECR\"></a>\n\nLet’s head over to AWS ECR and create a repository where we’ll push our docker image to.\n\n![](create-ECR-repo.png)\n\nOnce a repository is created, let’s push an image to it. Head over to the repository and click `View push commands`.\n\n![](view-push.png)\n\nLet’s follow the helper commands to push our image to the `Chainlit-demo-app` repository we just created.\n\n🚧 Note, we already created built an image to test the app locally. But that’s ok, let’s rebuild the image again to avoid confusion.\n\n![](push-commands.png)\n\nAwesome, this is what it looks like on my end.\n\n![](pushed.png)\n\nLet’s see if we find the image on AWS.\n\n![](find-pushed-image-aws.png)\n\n🚧 Take note of the image URI - we’ll need it later.\n\nGreat, our repository and our image is set. Let’s head over to ECS to create a service and a task.\n\n## Step 6: Create task definition and service and run task 🏃🏼‍♀️ <a name=\"RunTask\"></a>\n\n### Create a new cluster\n\n![](create-cluster.png)\n\n![](fill-in-cluster-details.png)\n\nClick create and we should see a new cluster `chainlit-demo-app-cluster` has been created for us.\n\n### Create a task definition\n\n![](create-task-definition.png)\n\n![](configure-task-definition.png)\n\n🚧 Make sure the container port matches the port we exposed in the Dockerfile.\n\nLeave everything else as default and create our task definition.\n\n![](fill-in-task-details.png)\n\n### Create a service\n\n![](create-service-1.png)\n\n![](create-service-2.png)\n\n![](create-service-3.png)\n\nWe should be good to create our service. Let’s hit it 👊🏼\n\n🚧 It may take a few minutes for the service to be ready.\n\nMap the ports correctly.\n\n**❗ One last thing we need to do before our task is ready is to allow traffic to the right port. You may have these set up already but if not, set the ports so that you allow all incoming traffic to port 8080.**\n\n![](security-groups.png)\n\n![](edit-inbound-rules-1.png)\n\n![](edit-inbound-rules-2.png)\n\nYour task should be running at this point. Head over to the tasks tab of the `chainlit-demo-app-service` .\n\n![](show-demo-app-service.png)\n\n![](get-public-ip.png)\n\n🚧 Our app is exposed at this public IP: `52.204.71.81:8080`\n\n## Step 7: Test out the application 💯 <a name=\"Test\"></a>\n\nHead over to the public IP in the browser to see our app in action!\n\n![](success.png)\n\n## Step 8: Ideas for next steps 🪜 <a name=\"NextSteps\"></a>\n\n1. We have our app running on a weird public IP address - we can connect it to our own domain.\n2. Load Balancer - Will give us a better performance and high availability.\n3. Right now our is not very secure. AWS Certificate Manager makes getting an SSL certificate relatively straightforward.\n\nI hope this helps the growing Chainlit community! Hit me up in the Chainlit Discord (ankushgarg) if you have any questions about the walkthrough.\n\n**Resources:**\n\n[Deploy to Fly.io](https://dev.to/willydouhard/how-to-deploy-your-chainlit-app-to-flyio-38ja)\n\n[Deploy to GCP](https://pseudohvr.medium.com/deploying-chainlit-on-gcp-72231ba6b77f)"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"visual","theme":"cosmo","title-block-banner":true,"title":"Deploy your chatGPT-like app with Chainlit and AWS ECS","date":"2/9/23","author":"Ankush Garg"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}